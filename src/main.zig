const std = @import("std");

var inClass = false;
var className: []u8 = undefined;
var inMethod = false;

pub fn main() !void {
    var gpa = std.heap.GeneralPurposeAllocator(.{}){};
    var allocator = gpa.allocator();

    var file = try std.fs.cwd().openFile("zig2.blah", .{});
    defer file.close();

    var buffer = std.io.bufferedReader(file.reader());
    var stream = buffer.reader();

    var buf: [1024]u8 = undefined;
    var lineCount: usize = 0;

    while (try stream.readUntilDelimiterOrEof(&buf, '\n')) |_| {
        lineCount += 1;
    }

    var lines = try allocator.alloc([]u8, lineCount);
    {
        try file.seekTo(0);

        var i: usize = 0;
        while (try stream.readUntilDelimiterOrEof(&buf, '\n')) |line| {
            if (line.len > 1024) {
                return error.OhNooooooo;
            }

            lines[i] = try allocator.alloc(u8, line.len);

            std.mem.copyForwards(u8, lines[i], line);

            i += 1;
        }
    }

    var i: i32 = @intCast(lineCount - 1);
    while (i >= 0) : (i -= 1) {
        const line = lines[@intCast(i)];

        if (std.mem.eql(u8, line, "} Main class public")) {
            inClass = true;
            var findIt = std.mem.split(u8, line, " ");
            _ = findIt.next();
            const clazz = findIt.next();

            className = try allocator.alloc(u8, clazz.?.len);
            std.mem.copyForwards(u8, className, clazz.?);

            if (!std.mem.eql(u8, className, "Main")) {
                return error.MainNameNotFollowingZig2PatternNullPointerInvalidExceptionException;
            }
        }

        // At this point I just kinda gave up lol.

        if (std.mem.eql(u8, line, "  }()main void static public")) {
            if (!inClass) {
                return error.NotInClassVirtualInheritedInterfaceExceptionError;
            }
            inMethod = true;
        }

        if (std.mem.eql(u8, line, "    ;()andrew")) {
            if (!inMethod) {
                return error.NotInMethodNullPointerCastInterpretationExceptionWarningError;
            }

            const squimbly =
                \\                  -*%%*+-----+#@*:                                                                  
                \\             .##-..................-%*                                                              
                \\          .#-..........................++                                                           
                \\        .#...............................:%                                                         
                \\      .%...................................-#                                                       
                \\     *.......................................+:                                                     
                \\   .%..........................................#.                                                   
                \\  .%............................................%.                                                  
                \\  %.....................:::.::...................%                                                  
                \\ =....................@===========%%-.........--..:                                                 
                \\.+.................:#=================++=====#*...%     -@@@@*:             .:.                     
                \\+................+%==========#@#==========+%+.....:-  -%#######%@#:       **++++*%%=.               
                \\#.............##=========##:...:*=========+###***@:#-%##############%#.  :-=*++++++++#%:            
                \\+........:#@*==========#:..:@...#==============*@#*@################@##%.    .%+++*+++++*#          
                \\+...+@+================*...:@...+==================%*%############%@#%%%@.     .- +++++++++%.       
                \\*..++===================*=..=.=#===================*:@@%#########@#%%####@       -*+++++++++*%      
                \\#..%==%===============================@#===========#:+-*%######@#@########@            =++++++@.    
                \\-:.@====+============================+%============%:@--#%###@#%%###########            *++++++#-   
                \\ @.:*======================+=====*##+=============@:-=---@#@%%########---##%*           .*++++++#:  
                \\ .+.:*+#@+=%+==+=+++*#%#+====@@====+=============%:-#-----@%%######*--=%*+%#%+      =@%++++++++++@  
                \\  =-..%===+==%%================================*+:-#-------@#####%--+%###--%#%=       #**+++++++++# 
                \\   +-..=#+====================================@::=+--------=%####=-==+***#-=%#%-           #++++++@.
                \\    =+.....+#@+=============================*=::#==#@%##@#--=%##%@%#=-=------=#%:          :++++++++
                \\      @........%*=========================+*::+**+--------@--+%%##%%%--#####==%#@.    .    *+++++++#
                \\       :%........#+================+====#=::+*=*----------=#--@####%%%*+#%=-=%####    .#**+++++++++#
                \\         .%........:%+==========%@====%-::*#-%-------------++-@#####%%#=--=%####%:     :%++++++++++%
                \\           .=#.........%+=+========%+:::%=--#---------------#@######%%##+%#####%.   #-   .=++++++++#
                \\               :@#.....#=@*====*@+:::#*----#------==---------@######%@#######@##%@ ++#   .++++++++**
                \\                  ..  :*-=++-::::=@+-------#@+---------------@#####%@######@%######@+++##+++++++++@.
                \\               .#%#@*@%#%@@@@@%+---------=*------------------@##%@@######@%########%*+++++++++++++# 
                \\              ######@*::-%---=#@==*#*---*--------------------@%*--+%###@%##########@+++++++++++++@  
                \\              %%##%*::::::+@%###%:-:::%*--------------------=#----=@%@*%##########%*++++++++++++%.  
                \\              %:*@::::-=-:%#####%#::::-*-------------------#%-----=#+++#%#######%@+++++++++++++@.   
                \\            .#:::%*=:::-+:++%#%+:::::::==----------------##-------=#++++%@%%%%@#+++++++++++++*%     
                \\             .*:::::::::%:%:-:::::::::::%@=-----------+%=---------=*++++++++++++++++++++++++@.      
                \\             .+::::::::@%%%#:::::::::::%####%%%%%#**++------------=*++++++++++++++++++++++%-        
                \\              .@-::::+@%@=:+:::::::::-%####%%=--------------------*++++++++++++++++++++**.          
                \\               .%%@%##@-   .*::-%@@%%###@#----------------------%#=#++++++++++++++++%=.             
                \\                @###@.       @######%@+-+@#--------------=#@%=-----@@*+++++++++*@-                  
                \\                             :%##@@=----------=+**+----------------#.                               
                \\                              .#.%---------------------------------=-                               
                \\                                *-----------------------------------*                               
                \\                               *----------------=-------------------%.                              
                \\                              *----------------+##------------------*.                              
                \\                              +----------------#  %=----------------*.                              
                \\                             *---------------*-    :@+--------------+.                              
                \\                             *-------------**.        +#------------+.                              
                \\                              *--------#+=-+-           .@=---------+.                              
                \\                               *------------%.            :#--------#.                              
                \\                                -#----------+=              .@-----*#:                              
                \\                                  :#--------++                =-:::::#                              
                \\                                    .%=----**:=               +::::::--                             
                \\                                   .#=::+#=:::*              %::::::+%                              
                \\                                 =#:::::::::::*.            *-:::-#-                                
                \\                                 %-:---------+*            .#:-==                                   
            ;

            std.debug.print("{s}\n", .{squimbly});
        }
    }
}
